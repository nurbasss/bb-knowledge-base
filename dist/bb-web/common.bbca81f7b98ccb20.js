"use strict";(self.webpackChunkbb_web=self.webpackChunkbb_web||[]).push([[592],{4135:(m,d,a)=>{a.d(d,{L:()=>n});var o=a(6985),s=a(2677),t=a(4537),c=a(5732);class n{constructor(r){this.http=r}createPost(r){return this.http.post(o.N.baseUrl+s.yA,r)}getPostById(r){return this.http.get(`${o.N.baseUrl+s.hY}/${r}`)}updatePost(r,u){return this.http.post(`${o.N.baseUrl+s.yA}/${u}`,r)}getPostVersionById(r){return this.http.get(`${o.N.baseUrl+s.zw}/${r}`)}revertPostVersion(r){return this.http.post(`${o.N.baseUrl+s.z6}`,r)}uploadImage(r){let u=new FormData;return u.append("image",r),this.http.post(`${o.N.baseUrl+s.GM}`,u)}}n.\u0275fac=function(r){return new(r||n)(t.LFG(c.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})},9923:(m,d,a)=>{a.d(d,{S:()=>l});var o=a(6985),s=a(4121),t=a(2677),c=a(4537),n=a(5732);class l{constructor(u){this.http=u,this.variablesList$=new s.X([]),this.isVariableListLoading$=new s.X(!1)}getAllVariables(){this.isVariableListLoading$.next(!0),this.http.get(`${o.N.baseUrl+t.Az}`).subscribe({next:u=>{this.isVariableListLoading$.next(!1),this.variablesList$.next(u?.vars)},error:u=>{this.isVariableListLoading$.next(!1)}})}createVariable(u){return this.http.post(`${o.N.baseUrl+t.bV}`,u)}getVariablesByIds(u){return this.http.post(`${o.N.baseUrl+t.S_}`,u)}deleteVariable(u){return this.http.post(`${o.N.baseUrl+t.bV}/${u}`,{_method:"DELETE"})}editVariable(u,p){return this.http.post(`${o.N.baseUrl+t.bV}/${p}`,u)}}l.\u0275fac=function(u){return new(u||l)(c.LFG(n.eN))},l.\u0275prov=c.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})},3891:(m,d,a)=>{a.d(d,{d:()=>h});var o=a(9900),s=a(7553),t=a(4537),c=a(5497),n=a(6943),l=a(9923),r=a(8292),u=a(3942),p=a(8692),v=a(6618);function E(_,i){if(1&_&&(t.TgZ(0,"ng-option",14),t._uU(1),t.qZA()),2&_){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",null==e?null:e.title," ")}}function D(_,i){if(1&_&&(t.TgZ(0,"ng-option",14),t._uU(1),t.qZA()),2&_){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",null==e?null:e.title," ")}}class h{constructor(i,e,g,b,f,P,M){this.activeModal=i,this.fb=e,this.categoryService=g,this.changeDetector=b,this.variableService=f,this.toastr=P,this.helperService=M,this.type="create",this.subcategories=[]}ngAfterViewInit(){"edit"===this.type&&(this.form.controls.name.setValue(this.editVariable.name),this.form.controls.varValue.setValue(this.editVariable.value),this.form.controls.category.setValue(this.categoryService.getCategoryById(this.editVariable?.category_id)),this.onCategoryChange(this.form.controls.category.value),this.form.controls.subcategory.setValue(this.categoryService.getLocalSubcategoryById(this.editVariable?.sub_category_id)),this.changeDetector.detectChanges())}close(){this.activeModal.close()}ngOnInit(){this.form=this.fb.group({name:[null,o.kI.required],varValue:[null,o.kI.required],category:[null,o.kI.required],subcategory:[null,o.kI.required]})}createVariable(){if(this.form.valid){const i={name:this.form.controls.name.value,value:this.form.controls.varValue.value,category_id:this.form.controls.category?.value?.id,sub_category_id:this.form.controls.subcategory?.value?.id};"edit"===this.type&&this.editVariable?(i._method="PUT",this.variableService.editVariable(i,this.editVariable.id).subscribe({next:e=>{this.variableService.getAllVariables(),this.close(),(0,s.PE)("\u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0430",this.toastr)},error:e=>{(0,s.N3)(e,this.toastr)}})):this.variableService.createVariable(i).subscribe({next:e=>{this.variableService.getAllVariables(),this.activeModal.close(e?.vars),(0,s.PE)("\u041d\u043e\u0432\u0430\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0430",this.toastr)},error:e=>{(0,s.N3)(e,this.toastr)}})}else(0,s.Ss)(this.form,this.toastr)}onCategoryChange(i){console.log(i),this.subcategories=[],this.form.controls.subcategory.setValue(null),i&&(this.subcategories=i.sub_categories),this.changeDetector.detectChanges()}}h.\u0275fac=function(i){return new(i||h)(t.Y36(c.Kz),t.Y36(o.qu),t.Y36(n.H),t.Y36(t.sBO),t.Y36(l.S),t.Y36(r._W),t.Y36(u.W))},h.\u0275cmp=t.Xpm({type:h,selectors:[["bb-add-variable-modal"]],inputs:{type:"type",editVariable:"editVariable"},decls:29,vars:11,consts:[[1,"modal-header"],[1,"modal__title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body",3,"formGroup"],[1,"row"],[1,"col-6","mb_24"],[1,"modal__subtitle"],["type","text","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435","id","name","formControlName","name",1,"form-control","base-input",3,"autocomplete"],["formControlName","category","placeholder","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044e","dropdownPosition","bottom","notFoundText","\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e",1,"base-select",3,"searchable","change"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435","id","varValue","formControlName","varValue",1,"form-control","base-input",3,"autocomplete"],["formControlName","subcategory","placeholder","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u0434\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044e","dropdownPosition","bottom","notFoundText","\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e",1,"base-select",3,"searchable"],[1,"modal-footer"],["type","button",1,"_btn","btn-success","variable-button",3,"click"],[3,"value"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return e.close()}),t.qZA()(),t.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"p",6),t._uU(8,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),t.qZA(),t._UZ(9,"input",7),t.qZA(),t.TgZ(10,"div",5)(11,"p",6),t._uU(12,"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"),t.qZA(),t.TgZ(13,"ng-select",8),t.NdJ("change",function(b){return e.onCategoryChange(b)}),t.YNc(14,E,2,2,"ng-option",9),t.ALo(15,"async"),t.qZA()()(),t.TgZ(16,"div",4)(17,"div",5)(18,"p",6),t._uU(19,"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435"),t.qZA(),t._UZ(20,"input",10),t.qZA(),t.TgZ(21,"div",5)(22,"p",6),t._uU(23,"\u041f\u043e\u0434\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"),t.qZA(),t.TgZ(24,"ng-select",11),t.YNc(25,D,2,2,"ng-option",9),t.qZA()()()(),t.TgZ(26,"div",12)(27,"button",13),t.NdJ("click",function(){return e.createVariable()}),t._uU(28),t.qZA()()),2&i&&(t.xp6(2),t.hij(" ","edit"===e.type?"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439"," "),t.xp6(2),t.Q6J("formGroup",e.form),t.xp6(5),t.Q6J("autocomplete",!1),t.xp6(4),t.Q6J("searchable",!0),t.xp6(1),t.Q6J("ngForOf",t.lcZ(15,9,e.categoryService.categoryListObserver$)),t.xp6(6),t.Q6J("autocomplete",!1),t.xp6(4),t.Q6J("searchable",!0),t.xp6(1),t.Q6J("ngForOf",e.subcategories),t.xp6(3),t.hij(" ","edit"===e.type?"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"," "))},dependencies:[p.sg,o.Fj,o.JJ,o.JL,o.sg,o.u,v.w9,v.jq,p.Ov],styles:[".modal-header[_ngcontent-%COMP%]{border-bottom:none;padding:24px}.modal-body[_ngcontent-%COMP%]{padding:24px;margin-bottom:32px}.modal__title[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#152536;letter-spacing:.02em}.modal__subtitle[_ngcontent-%COMP%]{font-size:22px;font-weight:600;color:#152536;letter-spacing:.02em;margin-bottom:16px}.variable-button[_ngcontent-%COMP%]{max-width:120px;height:40px}"]})}}]);